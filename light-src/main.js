var ql=[],bc="#333";function rf(e,t,n){const o=new XMLHttpRequest;o.overrideMimeType(t),o.open("GET",e,!0),o.onload=()=>{4===o.readyState&&"200"==o.status&&n(o)},o.send(null)}function ff(e){return/^(edge|file)/.test(e)?"":(s=e.slice(8).indexOf("/"),s>-1&&(e=e.slice(0,s+9)),"https://www.google.com/s2/favicons?domain="+e)}function q(e){for(var t=document.getElementById("quick-links"),n=0;n<e.length;n++){var o=document.createElement("div");o.className="bookmark";var i=o.appendChild(document.createElement("a"));i.href=e[n].url,i.style.background="url("+e[n].favIconUrl+") no-repeat center center",i.title=e[n].url,t.appendChild(o),ql.push(e[n].url)}}function w(e){const t=document.createElement.bind(document),n=document.getElementById("sidebar");var o=t("ul");nQ=ql.length;for(var i=0;i<e.length;i++){var l=e[i].hasOwnProperty("tab")?e[i].tab:e[i];if(l.hasOwnProperty("url")&&!l.url.startsWith("chrome.//")){for(var r=l.url.includes.bind(l.url),a=0;a<nQ;a++)r(ql[a]);var s=o.appendChild(t("li")).appendChild(t("a"));s.href=l.url,s.appendChild(document.createTextNode(l.title));var c=new Image;c.src=l.favIconUrl?l.favIconUrl:ff(l.url),s.insertAdjacentElement("afterbegin",c)}}n.appendChild(o)}function ab(e){e.preventDefault();let t=e.target,n=document.createElement("a"),o=document.createElement("a");n.href=t.querySelector('[placeholder="URL"]').value,o.href=t.querySelector('[placeholder="Ikooni URL"]').value;let i={url:n.href,favIconUrl:o.href};q([i]);let l=JSON.parse(localStorage.getItem("quick-links"));l.push(i),localStorage.setItem("quick-links",JSON.stringify(l))}function mb(e){e.preventDefault();let t=document.getElementById("quick-links"),n=t.childNodes;for(var o=0;n[++o]!=e.currentTarget;);if(o>1){let e=t.removeChild(n[o]);t.insertBefore(e,n[o-1]);let i=JSON.parse(localStorage.getItem("quick-links"));[i[o-1],i[o-2]]=[i[o-2],i[o-1]],localStorage.setItem("quick-links",JSON.stringify(i))}}function db(e){e.preventDefault();let t=document.getElementById("quick-links"),n=t.childNodes;for(var o=0;n[++o]!=e.currentTarget;);t.removeChild(n[o]);let i=JSON.parse(localStorage.getItem("quick-links"));i.splice(o-1,1),localStorage.setItem("quick-links",JSON.stringify(i))}function sb(e,t){let n=document.getElementsByClassName("bookmark");bc=bc!=e?e:"#333";for(let o=n.length;o--;)n[o].removeEventListener("click",db),n[o].removeEventListener("click",mb),n[o].style.background=bc,t&&bc==e&&n[o].addEventListener("click",t)}document.addEventListener("DOMContentLoaded",e=>{const t=document.getElementById.bind(document);var n;window.location.origin.startsWith("chrome-extens")?n="2":window.location.origin.startsWith("moz-extens")&&(n="unfiled_____"),void 0!==n&&(chrome.sessions.getRecentlyClosed(w),chrome.topSites.get(w),chrome.bookmarks.getSubTree(n,function(e){let t=e[0].children;w(t.find(e=>"m"==e.title).children),w(t.find(e=>"a"==e.title).children)}));let o=e=>{var t=JSON.parse(e);let n=JSON.parse(localStorage.getItem("quick-links"));n?q(n):(localStorage.setItem("quick-links",JSON.stringify(t.quickLinks)),q(t.quickLinks)),len=t.slowLinks.length;for(let e=0;e<len;w(t.slowLinks[e++]));},i=localStorage.getItem("staticLinks");i?o(i):rf("links.json","application/json",e=>{rt=e.responseText,localStorage.setItem("staticLinks",rt),o(rt)}),t("quick-links-add").addEventListener("click",e=>{sb("#333");let n=t("bookmark-form"),o=t("quick-links-add").getBoundingClientRect().top;n.style.top=o.toString()+"px",n.style.display="block"!=n.style.display?"block":"none"}),t("bookmark-form").addEventListener("submit",ab),t("quick-links-move").addEventListener("click",e=>{sb("darkblue",mb)}),t("quick-links-del").addEventListener("click",e=>{sb("darkred",db)});const l=t("notepad");l.value=localStorage.getItem("localnotes"),l.hidden=!localStorage.getItem("showNotes"),t("btn-toggle-notes").innerHTML=l.hidden?"&#x25BD;":"&#x25B3;";var r=()=>{localStorage.setItem("localnotes",l.value)},a=()=>{"100%"==l.style.width?(l.style.width="57%",l.style.height="50%"):(l.style.width="100%",l.style.height="100%",l.scrollIntoView(!0))},s=()=>{l.hidden?(l.hidden=!1,localStorage.setItem("showNotes",1),t("btn-toggle-notes").innerHTML="&#x25B3;"):(l.hidden=!0,localStorage.setItem("showNotes",""),t("btn-toggle-notes").innerHTML="&#x25BD;")};t("btn-save-notes").addEventListener("click",r),t("btn-resize-notes").addEventListener("click",a),t("btn-toggle-notes").addEventListener("click",s),window.addEventListener("keydown",e=>{e.ctrlKey&&"s"==e.key?(e.preventDefault(),r()):e.altKey&&"q"==e.key?(e.preventDefault(),a()):e.altKey&&40==e.keyCode&&(e.preventDefault(),s())});var c=t("searchForm"),d=c.children[0];c.addEventListener("click",function(e){if(e.target.name){let n=e.target.name.split("&");for(var t=0;t<n.length-1;t++){let e=n[t].split("="),o=document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("name",e[0]),o.setAttribute("value",e[1]),c.appendChild(o)}d.name=n[t]}else d.name="q";c.target=e.ctrlKey?"_blank":"_self"});var k=t("sidebar");document.addEventListener("mousemove",e=>{if(e.altKey)return;let t=k.style.display,n=k.offsetWidth,o=window.innerWidth,i=e.clientX;k.style.display=e.clientY>5&&(o-i<20||t&&o-n-i<0)?"flex":"none"}),d.focus()});