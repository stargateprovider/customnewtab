const _=e=>document.createElement(e),$=e=>document.getElementById(e);var ql=[],bc="#333";function ff(e){return/^(edge|file)/.test(e)?"":(s=e.slice(8).indexOf("/"),s>-1&&(e=e.slice(0,s+9)),"https://www.google.com/s2/favicons?domain="+e)}function q(e){for(var t=$("quick-links"),n=0;n<e.length;n++){var o=_("div");o.className="bookmark";var i=o.appendChild(_("a"));i.href=e[n].url,i.style.background="url("+e[n].favIconUrl+") no-repeat center center",i.title=e[n].url,t.append(o),ql.push(e[n].url)}}function w(e){n=$("sidebar");var o=_("ul");nQ=ql.length;for(var i=0;i<e.length;i++){var l=e[i].hasOwnProperty("tab")?e[i].tab:e[i];if(l.hasOwnProperty("url")&&!l.url.startsWith("chrome.//")){for(var r=e=>l.url.includes(e),a=0;a<nQ;a++)r(ql[a]);var s=o.appendChild(_("li")).appendChild(_("a"));s.href=l.url,s.append(l.title);var c=new Image;c.src=l.favIconUrl?l.favIconUrl:ff(l.url),s.insertAdjacentElement("afterbegin",c)}}n.append(o)}function ab(e){e.preventDefault();let t=e.target,n=_("a"),o=_("a");n.href=t.querySelector('[placeholder="URL"]').value,o.href=t.querySelector('[placeholder="Ikooni URL"]').value;let i={url:n.href,favIconUrl:o.href};q([i]);let l=JSON.parse(localStorage.getItem("quick-links"));l.push(i),localStorage.setItem("quick-links",JSON.stringify(l))}function mb(e){e.preventDefault();let t=$("quick-links"),n=t.childNodes;for(var o=0;n[++o]!=e.currentTarget;);if(o>1){let e=t.removeChild(n[o]);t.insertBefore(e,n[o-1]);let i=JSON.parse(localStorage.getItem("quick-links"));[i[o-1],i[o-2]]=[i[o-2],i[o-1]],localStorage.setItem("quick-links",JSON.stringify(i))}}function db(e){e.preventDefault();let t=$("quick-links"),n=t.childNodes;for(var o=0;n[++o]!=e.currentTarget;);t.removeChild(n[o]);let i=JSON.parse(localStorage.getItem("quick-links"));i.splice(o-1,1),localStorage.setItem("quick-links",JSON.stringify(i))}function sb(e,t){let n=document.getElementsByClassName("bookmark");bc=bc!=e?e:"#333";for(let o=n.length;o--;)n[o].removeEventListener("click",db),n[o].removeEventListener("click",mb),n[o].style.background=bc,t&&bc==e&&n[o].addEventListener("click",t)}document.addEventListener("DOMContentLoaded",e=>{var n;window.location.origin.startsWith("chrome-extens")?n="2":window.location.origin.startsWith("moz-extens")&&(n="unfiled_____"),void 0!==n&&(chrome.sessions.getRecentlyClosed(w),chrome.topSites.get(w),chrome.bookmarks.getSubTree(n,function(e){let t=e[0].children;w(t.find(e=>"m"==e.title).children),w(t.find(e=>"a"==e.title).children)}));let o=t=>{let n=localStorage.getItem("quick-links");n?q(JSON.parse(n)):(localStorage.setItem("quick-links",JSON.stringify(t.quickLinks)),q(t.quickLinks)),len=t.slowLinks.length;for(let e=0;e<len;w(t.slowLinks[e++]));},i=localStorage.getItem("staticLinks");i?o(JSON.parse(i)):fetch("links.json").then(e=>e.json()).then(e=>{localStorage.setItem("staticLinks",e.stringify()),o(e)}),$("quick-links-add").addEventListener("click",e=>{sb("#333");let n=$("bookmark-form"),o=$("quick-links-add").getBoundingClientRect().top;n.style.top=o.toString()+"px",n.style.display="block"!=n.style.display?"block":"none"}),$("bookmark-form").addEventListener("submit",ab),$("quick-links-move").addEventListener("click",e=>{sb("darkblue",mb)}),$("quick-links-del").addEventListener("click",e=>{sb("darkred",db)});const l=$("notepad");l.value=localStorage.getItem("localnotes"),l.hidden=!localStorage.getItem("showNotes"),$("btn-toggle-notes").innerHTML=l.hidden?"&#x25BD;":"&#x25B3;";var r=()=>{localStorage.setItem("localnotes",l.value)},a=()=>{"100%"==l.style.width?(l.style.width="57%",l.style.height="50%"):(l.style.width="100%",l.style.height="100%",l.scrollIntoView(!0))},s=()=>{l.hidden?(l.hidden=!1,localStorage.setItem("showNotes",1),$("btn-toggle-notes").innerHTML="&#x25B3;"):(l.hidden=!0,localStorage.setItem("showNotes",""),$("btn-toggle-notes").innerHTML="&#x25BD;")};$("btn-save-notes").addEventListener("click",r),$("btn-resize-notes").addEventListener("click",a),$("btn-toggle-notes").addEventListener("click",s),window.addEventListener("keydown",e=>{e.ctrlKey&&"s"==e.key?(e.preventDefault(),r()):e.altKey&&"q"==e.key?(e.preventDefault(),a()):e.altKey&&40==e.keyCode&&(e.preventDefault(),s())});var u=$("sidebar");document.addEventListener("mousemove",e=>{if(!e.altKey){let r=u.style.display,a=u.offsetWidth,t=window.innerWidth,s=e.clientX;u.style.display=e.clientY>5&&(t-s<20||r&&t-a-s<0)?"flex":"none"}});var m=$("searchForm"),k=m.children[0];m.addEventListener("click",e=>{if(e.target.hasAttribute("formaction")){e.preventDefault();let r=e.target.getAttribute("formaction").replace("%s",k.value);window.open(r,e.ctrlKey?"_blank":"_self")}}),k.focus()});